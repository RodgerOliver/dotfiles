#!/bin/bash

remote_branches=$(git branch -a | grep 'remotes/origin' | grep -v HEAD | sed "s/remotes\/origin\///")
local_branches=$(git branch | awk '{if ($1 == "*") print $2; else print $1}')
outdate_branches=$(git branch -v | grep '\[behind .*\]' | awk '{if ($1 == "*") print $2; else print $1}')
gone_branches=$(git branch -v | grep '\[gone\]' | awk '{if ($1 == "*") print $2; else print $1}')
new_branches=$(git branch -vv | grep '^[*]\?\ \+.\+\ \+[a-f0-9]\{7\}\ [^\[]' | awk '{if ($1 == "*") print $2; else print $1}')

echo "Updating Local Branches"
for branch in ${outdate_branches}; do
	echo "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
	read -p "Update branch $branch? (yes/no): " -r
	if [[ $REPLY =~ ^[Yy]$ ]]; then
		git checkout $branch
		git pull
	fi
done

echo ""
echo "Getting Remote Branches"
for branch_r in ${remote_branches}; do
	for branch_l in ${local_branches}; do
		get=0
		if [ $branch_l == $branch_r ]; then
			get=1
			break
		fi
	done
	if [ $get == 0 ]; then
		echo "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
		git checkout $branch_r
		echo "Got branch $branch_r"
	fi
done

echo ""
git checkout master
